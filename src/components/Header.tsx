'use client';

import Link from 'next/link';
import Image from 'next/image';
import { useState, useEffect } from 'react';
import { usePathname } from 'next/navigation';
import ThemeToggle from './ThemeToggle';
import { useTheme } from '@/context/ThemeContext';

const Header = () => {
  const [isScrolled, setIsScrolled] = useState(false);
  const pathname = usePathname(); // Get current path for active link styling
  const { theme } = useTheme();

  // Scroll detection
  useEffect(() => {
    const handleScroll = () => {
      setIsScrolled(window.scrollY > 50); // Change state if scrolled more than 50px
    };

    window.addEventListener('scroll', handleScroll);
    // Initial check in case page loads already scrolled
    handleScroll();

    // Cleanup listener on component unmount
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  // Define navigation links
  const navLinks = [
    { href: '/', label: 'Home' },
    { href: '/about', label: 'About' },
    { href: '/projects', label: 'Work' },
    { href: '/contact', label: 'Contact' },
    // Add other links like Services if needed
  ];

  // Dynamic classes based on scroll state
  const navClasses = `
    fixed z-50 transition-all duration-300 ease-in-out 
    ${
      isScrolled
        ? 'top-0 left-0 right-0 bg-card/90 backdrop-blur-sm shadow-lg rounded-none'
        : 'bottom-5 left-1/2 -translate-x-1/2 bg-card/80 backdrop-blur-md shadow-xl rounded-full px-6 py-3'
    }
  `;

  const linkBaseClasses =
    'transition-colors duration-200 px-3 py-1 rounded-full text-sm md:text-base';
  const linkInactiveClasses =
    'text-secondary-foreground hover:text-foreground hover:bg-secondary/50';
  const linkActiveClasses = 'text-primary-foreground bg-primary font-semibold';

  const availableText = 'Available for work';

  return (
    <nav className={navClasses}>
      {/* Desktop Navigation (always visible in this design) */}
      {/* Hide on very small screens if needed, but reference shows it always */}
      <div
        className={`${
          isScrolled
            ? 'container mx-auto flex justify-between items-center px-4 py-3'
            : 'flex items-center space-x-1 md:space-x-2'
        }`}
      >
        {isScrolled && (
          <Link
            href="/"
            className="flex items-center text-primary hover:text-primary/80 transition-colors"
          >
            <div className="relative w-[120px] h-[36px]">
              {theme === 'dark' ? (
                // White version for dark mode - using inline style to force white color
                <svg
                  width="120"
                  height="36"
                  viewBox="0 0 3515 1063"
                  xmlns="http://www.w3.org/2000/svg"
                  fill="white"
                >
                  <path
                    d="M0 0 C3.17037202 9.6237824 6.33676934 19.24886826 9.5 28.875 C9.73940811 29.60353683 9.97881622 30.33207367 10.22547913 31.08268738 C16.47841129 50.11399417 22.6820334 69.1587495 28.75 88.25 C35.78725081 110.38677967 43.05017157 132.44717835 50.32668686 154.50612259 C57.30470528 175.66138203 64.23115801 196.82922483 70.97509766 218.06054688 C77.18121266 237.58525495 83.58478156 257.04328239 90 276.5 C96.72995792 296.91129105 103.43096909 317.32858996 109.9375 337.8125 C116.9102574 359.76363518 124.11268184 381.63693596 131.32773972 403.50928116 C138.28323357 424.59604534 145.1871499 445.69530688 151.90771484 466.85839844 C158.29412785 486.95331331 164.89474353 506.97625908 171.5 527 C178.754014 548.99050749 185.96484411 570.99081341 192.97509766 593.06054688 C199.18121266 612.58525495 205.58478156 632.04328239 212 651.5 C218.72995792 671.91129105 225.43096909 692.32858996 231.9375 712.8125 C238.9102574 734.76363518 246.11268184 756.63693596 253.32773972 778.50928116 C260.28080492 799.58868247 267.18253996 820.68051023 273.90066528 841.83624268 C281.46485638 865.63730204 289.30655629 889.34729052 297.13476562 913.0625 C300.09761685 922.03911762 303.05407154 931.01781362 306 940 C306.34734066 941.05861992 306.34734066 941.05861992 306.7016983 942.1386261 C308.22706399 946.79037701 309.74285666 951.44514136 311.25390625 956.1015625 C311.63683334 957.27117523 312.01976044 958.44078796 312.41429138 959.64584351 C312.92960167 961.24161728 312.92960167 961.24161728 313.45532227 962.86962891 C313.7555983 963.79385651 314.05587433 964.71808411 314.36524963 965.6703186 C315 968 315 968 315 971 C291.24094698 976.87993236 267.44113916 982.57911026 243.60722351 988.14705658 C241.55794512 988.62606468 239.50886941 989.10593144 237.45983887 989.58599854 C233.60022234 990.49000531 229.73965037 991.38988269 225.87890625 992.2890625 C224.70677078 992.56359253 223.53463531 992.83812256 222.32698059 993.12097168 C221.25687241 993.36931763 220.18676422 993.61766357 219.08422852 993.87353516 C218.14644058 994.0920816 217.20865265 994.31062805 216.2424469 994.53579712 C214 995 214 995 212 995 C202.59924836 967.6695182 193.40754772 940.27602459 184.38460541 912.81862259 C182.76277517 907.88496717 181.13825378 902.9521978 179.51416016 898.01928711 C170.75672951 871.41505832 162.01630786 844.8051969 153.29467773 818.18920898 C152.89297867 816.96354218 152.4912796 815.73787537 152.07740784 814.47506714 C151.34765388 812.24813246 150.6181624 810.02111174 149.88902283 807.79397583 C149.56454666 806.80372406 149.2400705 805.81347229 148.90576172 804.79321289 C148.59588318 803.84519806 148.28600464 802.89718323 147.96673584 801.92044067 C147.27878964 799.84220381 146.57771187 797.76829403 145.86773682 795.69747925 C145.50033386 794.62225006 145.13293091 793.54702087 144.75439453 792.43920898 C144.41860382 791.46829819 144.08281311 790.49738739 143.73684692 789.49705505 C143 787 143 787 143 784 C142.10081172 784.00240362 141.20162343 784.00480723 140.27518702 784.00728369 C117.82351594 784.05870028 95.38205958 783.909491 72.93297124 783.57728505 C68.61827958 783.51403031 64.30354487 783.45383783 59.98881531 783.39323425 C52.5558793 783.28844928 45.12297083 783.18187353 37.69007874 783.07402039 C26.92237193 782.91780659 16.15462167 782.76476747 5.38685864 782.61248404 C-12.12346884 782.36478678 -29.6337665 782.115046 -47.14404297 781.86376953 C-48.18608818 781.84881646 -49.22813339 781.83386338 -50.30175573 781.81845719 C-52.41081779 781.7881921 -54.51987986 781.757927 -56.62894192 781.72766188 C-57.67466196 781.71265614 -58.720382 781.6976504 -59.79779053 781.68218994 C-60.84445258 781.66717043 -61.89111463 781.65215093 -62.96949372 781.63667628 C-74.62695446 781.46942755 -86.28442316 781.30273697 -97.94189453 781.13623047 C-99.5102815 781.113828 -99.5102815 781.113828 -101.11035305 781.09097296 C-118.58608731 780.84139831 -136.06183775 780.59297014 -153.53759718 780.34516478 C-164.27290597 780.19286897 -175.0081976 780.03944869 -185.74346876 779.8845228 C-193.09398739 779.77849418 -200.44451962 779.67344799 -207.79506302 779.56915104 C-212.02250818 779.50912746 -216.24994541 779.44864395 -220.47736549 779.38687706 C-236.98519953 779.145942 -253.48984872 778.91577652 -270 779 C-270.27604537 779.75686065 -270.55209074 780.51372129 -270.83650112 781.29351711 C-283.46224405 815.91023813 -296.11075134 850.51829588 -308.83056641 885.10058594 C-312.17981587 894.20716817 -315.5246599 903.31536899 -318.8699646 912.42340088 C-320.74647482 917.53232906 -322.62325042 922.64115974 -324.5 927.75 C-325.25000128 929.7916662 -326.00000128 931.83333286 -326.75 933.875 C-331.25 946.125 -331.25 946.125 -332.37484741 949.18707275 C-333.12536628 951.23015981 -333.8758749 953.27325064 -334.62637329 955.31634521 C-336.49335084 960.39881072 -338.36050253 965.48121212 -340.22802734 970.56347656 C-343.69867971 980.00903706 -347.16769313 989.45518905 -350.63067627 998.90356445 C-352.2410744 1003.29703777 -353.85243772 1007.69015682 -355.46386719 1012.08325195 C-356.22118149 1014.14866907 -356.97803914 1016.21425369 -357.734375 1018.2800293 C-362.71892158 1031.8938464 -367.80398608 1045.4654238 -373 1059 C-376.66915168 1058.18646395 -379.11790285 1056.78964202 -382.25390625 1054.68359375 C-383.27419922 1054.00103516 -384.29449219 1053.31847656 -385.34570312 1052.61523438 C-386.40724609 1051.89658203 -387.46878906 1051.17792969 -388.5625 1050.4375 C-389.59697266 1049.74591797 -390.63144531 1049.05433594 -391.69726562 1048.34179688 C-397.70867961 1044.30281929 -403.60696342 1040.13800225 -409.44702148 1035.85571289 C-413.16066639 1033.15633306 -416.94916311 1030.57442001 -420.75 1028 C-427.96913814 1023.08635907 -435.15081398 1018.12197511 -442.3125 1013.125 C-449.84514731 1007.87200271 -457.40451666 1002.66171451 -465 997.5 C-473.57120817 991.67520549 -482.08985022 985.77861799 -490.59008789 979.85083008 C-498.96540188 974.01374973 -507.38614024 968.24514247 -515.81835938 962.49072266 C-521.24777508 958.78078395 -526.66197313 955.04864405 -532.07910156 951.32080078 C-533.96575832 950.02354442 -535.85374916 948.72825495 -537.7421875 947.43359375 C-546.60885765 941.3518942 -555.43926886 935.21937826 -564.25952148 929.07055664 C-571.46524492 924.05270173 -578.70150679 919.08145627 -585.97387695 914.16064453 C-589.77638511 911.5759054 -593.45777416 908.94018746 -597 906 C-595.31007046 900.22112487 -592.66792304 895.00378915 -590.00390625 889.62890625 C-589.25352081 888.10318748 -589.25352081 888.10318748 -588.48797607 886.54664612 C-586.84953389 883.21691945 -585.20594957 879.8897576 -583.5625 876.5625 C-581.8416714 873.06770974 -580.12221489 869.57224642 -578.40275574 866.07678223 C-577.24680424 863.72719501 -576.09040002 861.37783047 -574.93354797 859.02868652 C-570.0319408 849.07430607 -565.16478502 839.10349253 -560.3125 829.125 C-558.78812472 825.99201013 -557.26330765 822.85923548 -555.73828125 819.7265625 C-555.3583754 818.94613083 -554.97846954 818.16569916 -554.58705139 817.36161804 C-549.7370454 807.4017152 -544.86766452 797.4512807 -540 787.5 C-533.1549258 773.50569869 -526.31926516 759.50689618 -519.5 745.5 C-512.70103518 731.53503343 -505.88652866 717.57773598 -499.0625 703.625 C-491.9929739 689.17008783 -484.9285617 674.71270973 -477.875 660.25 C-477.46547089 659.41031677 -477.05594177 658.57063354 -476.63400269 657.70550537 C-473.75571041 651.80381232 -470.87780551 645.90193042 -468 640 C-464.70860716 633.24986644 -461.41703155 626.49982209 -458.125 619.75 C-457.71554138 618.91045776 -457.30608276 618.07091553 -456.88421631 617.20593262 C-449.80087572 602.68339897 -442.70540813 588.16681214 -435.60705566 573.65161133 C-429.02298271 560.18768184 -422.44494579 546.72082888 -415.875 533.25 C-415.26057037 531.99020325 -415.26057037 531.99020325 -414.63372803 530.70495605 C-411.75552689 524.80344631 -408.87771579 518.90174642 -406 513 C-402.70860716 506.24986644 -399.41703155 499.49982209 -396.125 492.75 C-395.51081207 491.49068665 -395.51081207 491.49068665 -394.88421631 490.20593262 C-387.80087572 475.68339897 -380.70540813 461.16681214 -373.60705566 446.65161133 C-367.02298271 433.18768184 -360.44494579 419.72082888 -353.875 406.25 C-353.26057037 404.99020325 -353.26057037 404.99020325 -352.63372803 403.70495605 C-349.75552689 397.80344631 -346.87771579 391.90174642 -344 386 C-340.70860716 379.24986644 -337.41703155 372.49982209 -334.125 365.75 C-333.71554138 364.91045776 -333.30608276 364.07091553 -332.88421631 363.20593262 C-325.80087572 348.68339897 -318.70540813 334.16681214 -311.60705566 319.65161133 C-305.02298271 306.18768184 -298.44494579 292.72082888 -291.875 279.25 C-291.26057037 277.99020325 -291.26057037 277.99020325 -290.63372803 276.70495605 C-287.75552689 270.80344631 -284.87771579 264.90174642 -282 259 C-278.70860716 252.24986644 -275.41703155 245.49982209 -272.125 238.75 C-271.71554138 237.91045776 -271.30608276 237.07091553 -270.88421631 236.20593262 C-263.80087572 221.68339897 -256.70540813 207.16681214 -249.60705566 192.65161133 C-243.02298271 179.18768184 -236.44494579 165.72082888 -229.875 152.25 C-229.46538025 151.4101355 -229.0557605 150.570271 -228.63372803 149.70495605 C-225.75552689 143.80344631 -222.87771579 137.90174642 -220 132 C-216.70860716 125.24986644 -213.41695922 118.49985737 -210.125 111.75 C-209.71720306 110.91378113 -209.30940613 110.07756226 -208.88925171 109.21600342 C-204.058371 99.31038201 -199.22229743 89.40732327 -194.37890625 79.5078125 C-193.90821716 78.54531082 -193.43752808 77.58280914 -192.95257568 76.59114075 C-190.60378431 71.78865726 -188.25227021 66.98754647 -185.89501953 62.18920898 C-181.68341354 53.6066736 -177.5137143 45.01144965 -173.48828125 36.33984375 C-172.47423645 34.17384253 -171.45898977 32.0084083 -170.44351196 29.84307861 C-169.52729908 27.87125169 -168.63384769 25.89018792 -167.7409668 23.90771484 C-166.92559448 22.16868896 -166.92559448 22.16868896 -166.09375 20.39453125 C-165.40829102 18.89176636 -165.40829102 18.89176636 -164.70898438 17.35864258 C-162.45190404 14.24354927 -160.67742403 14.0038817 -157 13 C-154.88557882 12.68979854 -152.7601667 12.4493646 -150.6309967 12.26596069 C-149.37074173 12.15382736 -148.11048676 12.04169403 -146.81204224 11.92616272 C-145.42817342 11.81049712 -144.04429239 11.6949777 -142.66040039 11.57958984 C-141.19300502 11.45183943 -139.72566512 11.32345055 -138.25837708 11.19447327 C-134.28373948 10.84699426 -130.30837172 10.50865698 -126.33279347 10.17213392 C-122.16629704 9.81804919 -118.00048471 9.45608493 -113.83457947 9.09512329 C-106.83846252 8.49009523 -99.8418845 7.89066039 -92.8449707 7.29492188 C-84.76468418 6.60690805 -76.68503846 5.91175144 -68.60572821 5.21237218 C-59.99265996 4.46681806 -51.37920092 3.72586355 -42.76559138 2.98659182 C-40.28904706 2.77377185 -37.81257134 2.56016791 -35.33610725 2.34641647 C-31.43838449 2.01026632 -27.54040534 1.67725548 -23.64221001 1.346632 C-22.21471878 1.22510636 -20.7873122 1.10258149 -19.36000061 0.97896385 C-17.40556835 0.80988126 -15.45078371 0.64488689 -13.49598694 0.48007202 C-12.40408082 0.38680319 -11.3121747 0.29353436 -10.18718052 0.19743919 C-6.78384613 -0.01339028 -3.40898829 -0.03305914 0 0 Z M-57 122 C-75.73219241 178.12797361 -94.45967353 234.25751755 -113.18079373 290.38918521 C-115.38888383 297.00971337 -117.59701818 303.63022677 -119.80517578 310.25073242 C-120.02491766 310.90956577 -120.24465953 311.56839912 -120.47106025 312.24719712 C-127.59837361 333.61634456 -134.72861056 354.98451509 -141.86035822 376.35218299 C-149.39434324 398.92506044 -156.92500845 421.49904267 -164.45215559 444.07420129 C-168.96353699 457.6042205 -173.47759325 471.13334129 -177.99502981 484.66134002 C-181.08873967 493.92666314 -184.17916335 503.19307812 -187.26695931 512.4603738 C-189.05095568 517.8142924 -190.83644071 523.16770284 -192.62581444 528.51982689 C-194.26173716 533.41307557 -195.89355853 538.30767131 -197.52203339 543.2034035 C-198.11399141 544.98055287 -198.70749412 546.75718857 -199.30264074 548.53327266 C-200.1073113 550.93536038 -200.90649144 553.33920449 -201.70424652 555.74359608 C-201.9400853 556.44323138 -202.17592408 557.14286667 -202.41890949 557.86370304 C-203.35777768 560.7103473 -204 562.97912543 -204 566 C-193.75630083 564.31654667 -183.67432039 561.93457445 -173.5625 559.609375 C-171.58150557 559.15578135 -169.60046052 558.70240871 -167.61936951 558.24923706 C-162.21199197 557.01166236 -156.80531344 555.77105849 -151.39875412 554.52991486 C-145.66995794 553.21532336 -139.94054095 551.9034432 -134.21118164 550.59130859 C-125.54712629 548.60679845 -116.88330331 546.62127829 -108.21971607 544.63472557 C-91.81797229 540.87384824 -75.41482859 537.11910932 -59.01116669 533.36660767 C-49.24640856 531.13281914 -39.48180589 528.89835125 -29.71721458 526.66383362 C-28.98333657 526.4958942 -28.24945855 526.32795479 -27.4933418 526.1549263 C-26.0158553 525.81682077 -24.53836909 525.47871398 -23.06088316 525.14060593 C-18.64195753 524.12939666 -14.22299365 523.11835476 -9.80400378 522.10742629 C-2.75364881 520.4945166 4.29658729 518.8810894 11.34658664 517.266626 C14.59446006 516.52287088 17.84241203 515.77946358 21.09048653 515.03658676 C24.63805063 514.22516827 28.18538592 513.41275672 31.73266602 512.60009766 C32.76411743 512.36441952 33.79556885 512.12874138 34.85827637 511.88592148 C40.25471498 510.6484267 45.63398476 509.3635586 51 508 C49.54878993 499.9141375 47.45503445 492.06200663 45.23828125 484.15625 C44.856142 482.78347939 44.47431013 481.41062318 44.09275818 480.03768921 C43.05524689 476.3081811 42.01311144 472.57997942 40.97007751 468.85201263 C40.07954965 465.66678693 39.19179286 462.48079162 38.30404472 459.29479027 C30.52117132 431.36385208 22.68433876 403.44793844 14.84619141 375.5324707 C7.9369667 350.92387602 1.05406093 326.3080317 -5.8125 301.6875 C-6.3066391 299.91578123 -6.80077973 298.14406289 -7.29492188 296.37234497 C-7.53986956 295.49409719 -7.78481724 294.6158494 -8.03718758 293.71098804 C-9.28646858 289.23179285 -10.53579524 284.75261038 -11.78515625 280.2734375 C-12.03465153 279.37893072 -12.2841468 278.48442394 -12.54120255 277.5628109 C-19.72983297 251.7907331 -26.93656262 226.02371294 -34.14278889 200.25655079 C-35.42337346 195.6775599 -36.70389423 191.09855117 -37.984375 186.51953125 C-38.2306986 185.63868803 -38.47702221 184.75784481 -38.73081017 183.85030937 C-44.49530521 163.23580009 -50.24844509 142.6181228 -56 122 C-56.33 122 -56.66 122 -57 122 Z M-241.23828125 307.625 C-247.64486581 316.26181466 -248.82906048 325.4907826 -248 336 C-245.54913825 347.48403792 -239.75010622 357.29992701 -230 364 C-219.32228506 369.71650204 -208.82232349 372.11061013 -196.8125 368.875 C-186.28810084 365.2187964 -177.38090731 358.96409542 -172.1875 349 C-167.45935339 338.64162618 -166.23001373 328.39453103 -169.9453125 317.4609375 C-172.32698585 311.90369969 -174.90143993 306.39904004 -180 303 C-181.57112213 305.35668319 -182.93245531 307.4042949 -184 310 C-183.35117127 313.02786742 -182.04385547 314.92807703 -180.4375 317.5625 C-176.80513114 323.72173415 -177.19812831 331.64406991 -178.4609375 338.50390625 C-180.87225193 346.65982272 -185.54070841 352.59796731 -192.77734375 356.9921875 C-198.51278397 359.59279132 -203.67898999 360.23577009 -209.9375 360.125 C-210.62134766 360.11597656 -211.30519531 360.10695313 -212.00976562 360.09765625 C-213.67333287 360.07438958 -215.33671631 360.03853167 -217 360 C-214.44181658 353.47611558 -211.73943104 347.04274164 -208.84765625 340.66015625 C-208.4656456 339.81255234 -208.08363495 338.96494843 -207.69004822 338.09165955 C-206.48283459 335.41437934 -205.27270972 332.73842699 -204.0625 330.0625 C-203.25566943 328.27417423 -202.44902742 326.48576337 -201.64257812 324.69726562 C-201.25008881 323.82750092 -200.85759949 322.95773621 -200.45321655 322.06161499 C-199.68164394 320.35145528 -198.91065695 318.64103122 -198.14028931 316.93032837 C-196.55730361 313.42031332 -194.9621818 309.91980255 -193.31982422 306.43701172 C-192.86236816 305.46650879 -192.40491211 304.49600586 -191.93359375 303.49609375 C-191.36016235 302.30584595 -191.36016235 302.30584595 -190.77514648 301.09155273 C-189.76832639 298.74664434 -189.76832639 298.74664434 -190 295 C-209.59200608 286.04365436 -227.67610238 291.8513067 -241.23828125 307.625 Z"
                    transform="translate(597,0)"
                  />
                </svg>
              ) : (
                // Regular version for light mode
                <Image
                  src="/akindejie.svg"
                  alt="Akindejie Logo"
                  fill
                  className="object-contain"
                  priority
                />
              )}
            </div>
          </Link>
        )}
        <div
          className={`flex items-center ${
            isScrolled
              ? 'space-x-6'
              : 'flex-grow justify-center space-x-1 md:space-x-2'
          }`}
        >
          {navLinks.map((link) => {
            const isActive =
              pathname === link.href ||
              (link.href !== '/' && pathname.startsWith(link.href));
            return (
              <Link
                key={link.href}
                href={link.href}
                className={`${linkBaseClasses} ${
                  isActive ? linkActiveClasses : linkInactiveClasses
                }`}
              >
                {link.label}
              </Link>
            );
          })}
        </div>

        {/* Right side items (Toggle and Banner when scrolled) */}
        <div className="flex items-center space-x-3">
          {/* Theme Toggle (Always visible or only when scrolled?) */}
          {/* Let's make it always visible for now, adjust if needed */}
          <ThemeToggle />

          {/* Available for Work Banner (Only when scrolled) */}
          {isScrolled && (
            <div className="hidden md:flex items-center bg-primary/20 dark:bg-primary/30 rounded-full px-3 py-1 overflow-hidden relative h-7 w-48">
              {' '}
              {/* Adjust width as needed */}
              <span className="absolute left-3 top-1/2 -translate-y-1/2 w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
              <div className="absolute left-0 top-0 bottom-0 flex items-center whitespace-nowrap animate-marquee">
                {/* Duplicate text for seamless loop */}
                <span className="text-foreground font-medium text-xs pl-7 pr-8">
                  {availableText}
                </span>
                <span className="text-foreground font-medium text-xs pl-7 pr-8">
                  {availableText}
                </span>
              </div>
            </div>
          )}
        </div>
      </div>

      {/* Mobile Navigation can be removed or adapted if this nav works on mobile */}
      {/* The reference site's nav seems to work on mobile too */}
      {/* Remove the old mobile menu logic if not needed */}
    </nav>
  );
};

export default Header;
